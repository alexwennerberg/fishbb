{{ template "header.html" . }}
<table class="nav-table h-feed" id="threads">
  <tr><th>Thread</th><th style="text-align:center;width:4rem;" class="hide-mobile">Replies</th><th style="width:30%" class="hide-mobile">Last Post</th></tr>
  {{ if (and $.User ($.User.Role.Can "user")) }}
  <div class="body-header">
	  <a href="/thread/new?forumid={{.Forum.ID}}"><button class="padded-button">New Thread</button></a>
      {{ end }}
  {{ template "pagelist.html" . }}
</div>
{{ if not (len .Threads) }}
<tr><td>No threads in this forum yet. Be the first to create one!</td></tr>
{{ else }} 
  {{ range .Threads }}
  <tr class="h-entry">
    <td>
		{{ if .Locked }} {{ template "lock.svg" }} {{ end }}
		{{ if .Pinned }} {{ template "pin.svg" }} {{ end }}
        <a class="title-link p-name u-url" href="{{$.Forum.Slug}}/{{.ID}}">{{.Title}}</a><br>
		<div class="flex-between">
		<div style="color:var(--text-alt)">
			by <a class="p-author h-card" href="/u/{{.Author.Username}}">{{.Author.Username}}</a> <time class="dt-published text-alt" datetime="{{ isodate .Created }}" title="{{.Created}}">{{ timeago .Created }}</time><br>
			<span class="mobile">Lastest <a href="{{.Latest.Slug}}">{{ timeago .Latest.Created }}</a> by <a href="/u/{{.Latest.Author.Username}}">{{.Latest.Author.Username}}</a></span>
		</div>
	  {{ if and $.User ($.User.Role.Can "mod")}}
	  <span>
		  <form style="display:inline;" method="POST" action="/thread/{{.ID}}/lock?s={{not .Locked}}"><button class="link-button" id="submit">{{ if .Locked}}Unl{{else}}L{{end}}ock</button></form>
		  <form style="display:inline;" method="POST" action="/thread/{{.ID}}/pin?s={{ not .Pinned}}"><button class="link-button" id="submit">{{ if .Pinned}}Unp{{else}}P{{end}}in</button></form>
	  </span>
		</div>
	  {{ end }}
    </td>
	<td style="text-align:center;" class="hide-mobile">{{.Replies}}</td>
    <td class="hide-mobile">
		<span style="color:var(--text-alt)">
		<a href="{{.Latest.Slug}}">{{ timeago .Latest.Created }}</a>
		by <a href="/u/{{.Latest.Author.Username}}">{{.Latest.Author.Username}}</a>
		</div>
    </td>
  </tr>
  {{ end }}
</td>
</tr>
{{ end }}
</table>
{{ $pages := pageArr .ItemCount }}
{{ $length := len $pages }}
{{ if ne $length 1 }}
<div class="body-footer">
{{ template "pagelist.html" . }}
</div>
{{ end }}
{{ template "footer.html" . }}
